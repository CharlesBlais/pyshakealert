{#
  chanfile_local.dat template
  ===========================
  Jinja2 template for generating chanfile_local.dat used by ShakeAlert

  Variables required are:
  - user = user that generated the report
  - now = now timestamp
  - inventory = obspy.Inventory object
    as the columns of the file
#}
# Program: fdsnws2chanfile
# Generated by {{ user }} at {{ now.isoformat() }}
# Epoch time: {{ now.isoformat() }}
# distinct: 
# override: 0
# clipcheck: 1
# dupcheck: 1
# gaincheck: 1
# zcheck: 1
# showsensortype: 1
# showgroundmotionclip: 1
# showazdip: 1

#columns: network station location channel latitude longitude elevation samplerate gain units groundmotionclip azimuth dip sensortype
{% for network in inventory %}
{% for station in network %}
{% for channel in station %}
{{ "%2s %5s %2s %3s %7.4f %9.4f %7.1f %8.2f %13.6e %20s %14.6f %5.1f %5.1f %s" % (
    network.code,
    station.code,
    '--' if not channel.location_code else channel.location_code,
    channel.code,
    channel.latitude,
    channel.longitude,
    channel.elevation,
    channel.sample_rate,
    channel.response.instrument_sensitivity.value/100.0,
    "counts/(cm/sec2)" if channel.code[1] == 'N' else "counts/(cm/sec)",
    99999.0,
    channel.azimuth,
    channel.dip,
    "UNKNOWN" if not channel.description else channel.description.upper()
)}}
{% endfor %}
{% endfor %}
{% endfor %}
# {{ inventory.get_contents().get("channels")|length }} rows returned
# Number of duplicates: 0
# Number of channels with bad gain: 0
# Number of channels with missing Z channel: 0
# Number of channels with bad groundmotion clip: 0
