{#-
    Template for CAP earthquake early warning

    :type event: :class:`pyshakealert.message.event.Event`
    :param event: Event object

    :param str areas: area coordinates
    :param [str] areas_en: text representing the areas impacted
    :param [str] areas_fr: text representing the areas impacted

    :type sent: :class:`datetime.datetime`
    :param sent: date/time the CAP message is sent

    :type expires: :class:`datetime.datetime`
    :param expires: date/time the CAP message will expire

    :type wpamexpire: :class:`datetime.datetime`
    :param wpamexpire: date/time the wireless should expire (according to NAADS)
        typically 15 minutes from the sent time

    :param [int] locations: CAP-CP location codes

    :param str status: Actual, Exercise, System, Test, or Draft

    :author: Charles Blais <charles.blais@canada.ca>
-#}
<?xml version="1.0" encoding="UTF-8"?>
<alert xmlns="urn:oasis:names:tc:emergency:cap:1.2">
    <identifier>{{ event.core.id }}</identifier>
    <sender>nrcan.earthquakeinfo-infoseisme.rncan@canada.ca</sender>
    <sent>{{ sent.strftime('%Y-%m-%dT%H:%M:%S-00:00') }}</sent>
    <status>{{ status if status is defined else 'Test' }}</status>
    <msgType>Alert</msgType>
    <source>Earthquakes Canada/Séismes Canada</source>
    <scope>Public</scope>
    <code>profile:CAP-CP:0.4</code>
    <incidents>earthquake séisme</incidents>
    <info>
        <language>en-CA</language>
        <category>Geo</category>
        <event>Earthquake Early Warning</event>
        <responseType>Prepare</responseType>
        <urgency>Immediate</urgency>
        <severity>Severe</severity>
        <certainty>Likely</certainty>
        <eventCode>
            <valueName>profile:CAP-CP:Event:0.4</valueName>
            <value>earthquake</value>
        </eventCode>
        <effective>{{ event.core.origintime.value.strftime('%Y-%m-%dT%H:%M:%S-00:00') }}</effective>
        <expires>{{ expires.strftime('%Y-%m-%dT%H:%M:%S-00:00') }}</expires>
        <senderName>Government of Canada/Natural Resources Canada/Earthquakes Canada</senderName>
        <headline>Earthquake early warning detected</headline>
        <description>An earthquake early warning is detected for the following areas: {{ areas_en|join(', ') }}</description>
        <instruction>Instructions to be determined</instruction>
        <web>http://www.earthquakescanada.nrcan.gc.ca/</web>
        <contact>nrcan.earthquakeinfo-infoseisme.rncan@canada.ca</contact>
        <parameter>
            <valueName>layer:SOREM:1.0:Broadcast_Immediately</valueName>
            <value>Yes</value>
        </parameter>
        <parameter>
            <valueName>layer:SOREM:1.0:Broadcast_Text</valueName>
            <value>Text to be determined</value>
        </parameter>
        <parameter>
            <valueName>layer:SOREM:2.0:WirelessImmediate</valueName>
            <value>Yes</value>
        </parameter>
        <parameter>
            <valueName>layer:SOREM:2.0:WirelessText</valueName>
            <value>Text to be determined</value>
        </parameter>
        <parameter>
            <valueName>layer:WPAM:1.0:Expires</valueName>
            <value>{{ wpamexpire.strftime('%Y-%m-%dT%H:%M:%S-00:00') }}</value>
        </parameter>
        <area>
            <areaDesc>{{ areas_en|join(', ') }}</areaDesc>
            <polygon>{{ area }}</polygon>
{% for location in locations %}
            <geocode>
                <valueName>profile:CAP-CP:Location:0.4</valueName>
                <value>{{ location }}</value>
            </geocode>
{% endfor %}
        </area>
    </info>
    <info>
        <language>fr-CA</language>
        <category>Geo</category>
        <event>Alertes précoces aux tremblements de terre</event>
        <responseType>Prepare</responseType>
        <urgency>Immediate</urgency>
        <severity>Severe</severity>
        <certainty>Likely</certainty>
        <eventCode>
            <valueName>profile:CAP-CP:Event:0.4</valueName>
            <value>earthquake</value>
        </eventCode>
        <effective>{{ event.core.origintime.value.strftime('%Y-%m-%dT%H:%M:%S-00:00') }}</effective>
        <expires>{{ expires.strftime('%Y-%m-%dT%H:%M:%S-00:00') }}</expires>
        <senderName>Gouvernement du Canada/Ressources naturelles Canada/Séismes Canada</senderName>
        <headline>Alertes précoces aux tremblements de terre détecté</headline>
        <description>Une alertes précoces aux tremblements de terre détecté pour les régions suivantes: {{ areas_fr|join(', ') }}</description>
        <instruction>Instructions à déterminer</instruction>
        <web>http://www.seimescanada.rncan.gc.ca/</web>
        <contact>nrcan.earthquakeinfo-infoseisme.rncan@canada.ca</contact>
        <parameter>
            <valueName>layer:SOREM:1.0:Broadcast_Immediately</valueName>
            <value>Yes</value>
        </parameter>
        <parameter>
            <valueName>layer:SOREM:1.0:Broadcast_Text</valueName>
            <value>Texte à déterminer</value>
        </parameter>
        <parameter>
            <valueName>layer:SOREM:2.0:WirelessImmediate</valueName>
            <value>Yes</value>
        </parameter>
        <parameter>
            <valueName>layer:SOREM:2.0:WirelessText</valueName>
            <value>Texte à déterminer</value>
        </parameter>
        <parameter>
            <valueName>layer:WPAM:1.0:Expires</valueName>
            <value>{{ wpamexpire.strftime('%Y-%m-%dT%H:%M:%S-00:00') }}</value>
        </parameter>
        <area>
            <areaDesc>{{ areas_fr|join(', ') }}</areaDesc>
            <polygon>{{ area }}</polygon>
{% for location in locations %}
            <geocode>
                <valueName>profile:CAP-CP:Location:0.4</valueName>
                <value>{{ location }}</value>
            </geocode>
{% endfor %}
        </area>
    </info>
</alert>
